# 診断情報の出力

## 診断情報とは
ストール時等において、トランザクション実行エンジンの状態を表現する情報。

## API
void print_diagnostics(std::ostream&)

## 現状の制約
- この機構はワーカースレッドの動作と並行する。従って、本機構とワーカースレッドのトランザクション処理によってデータ競合が発生する場所は排他制御する。性能面を考慮し、トランザクションやDMLの実行そのもの粒度では排他制御しない。

## 出力する情報
- トランザクションが開始されており、CC としてコミットされていない全てのトランザクション(*1)に関する情報
  - CC としてのコミット処理が完了していると、各種ローカルセットがクリアされているため、CCとしてコミット処理が完了して以降そのトランザクションに関するローカルセット情報は閲覧できない。
- ワーカーのID (Token)
- 各ワーカースレッドが処理しているトランザクションの状態
  - 1. 開始要求を受け付け、開始待ち合わせ中
  - 2. ユーザー操作受付中
  - 3. コミットを受諾し、コミット条件を待ち合わせ中
  - 4. コミット処理が完了
  - 5. アボート処理が完了
- (*1) の数
- 上記トランザクションが待機する対象の LTX
- future work
  - 各種オペレーティング中 (tx_begin, DML, commit / abort)
  - some lock waiting
  - index tree traversing
  - (read / write / node / write preserve) set